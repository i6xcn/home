<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>API</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Web App">
<meta name="renderer" content="webkit">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<style type="text/css">
*{margin:0;padding:0}body{color:#051b28;font-size:15px;background-color:#eee;}img{border:0;vertical-align:middle;}ul,li{list-style:none;-webkit-margin-before:0;-webkit-margin-after:0;-webkit-margin-start:0;-webkit-margin-end:0;-webkit-padding-start:0}a{text-decoration:none}.contant{background:#fff;max-width:640px;min-width:320px;margin:0 auto;position:relative;padding-bottom:40px;}.header{padding-top:60px;background:#ff5983;}.top{background:#fff;height:60px;overflow:hidden;}.logo{position: absolute;left:50%;width:75px;height:75px;background-repeat:no-repeat;background-position:center;background-size:cover;border-radius:100%;margin: 0 auto;overflow:hidden;transform: translate(-50%,-50%);}.navbar{border-bottom:#EDEDED 1px solid;overflow:hidden;}.navbar li{float:left;width:25%;text-align:center}.navbar li a{display:block;padding:8px 0;font-size:17px;color:#858585}.navbar li a:hover{color:#ff5983;background:#eeeeee;}.xhx{color:#ff5983!important;border-bottom:#ff5983 2px solid;display:block}.itemg{overflow:hidden;border-bottom:#EDEDED 1px solid;padding:10px 0;}.itemg_lf{float:left;width:15%;}.itemg_rg{float:right;width:83%;margin-right:1.5%;}.itemg_lf img{display:block;height:70%;width:70%;margin:auto;border-radius:50%;}.itemg_rg_tp{color:#C8C8C8;overflow:hidden;}.itemg_rg_tp div{width:50%;float:left}.itemg_rg_tp span{color:#0c6ad4;font-weight:700;}.itemg_rg_sm{width:98%;color:#737373;margin:10px 0;}.itemg_rg_main{overflow:hidden;}.play-btn{left:50%;top:50%;height:30%;transform:translate(-50%,-50%);position:absolute;border:0;}.itemg_rg_main ul{display:flex;flex-wrap: wrap;}.itemg_rg_main li{list-style:none;width:31%;position:relative;height:0;padding-bottom:23%;cursor:pointer;transition: all 0.6s;border: rgb(0 0 0 / 5%) 1px solid;}.itemg_rg_main li:hover {border-radius:15px;}.itemg_rg_main li:not(:nth-child(3n)){margin-right: 2%;margin-bottom:2%}.bottom{max-width:640px;min-width:320px;width:100%;position:fixed;display:flex;line-height:40px;height:40px;bottom:0;background:#ff5983;z-index:10000;}.childdiv{flex:1;text-align:center;}.bottom a{color:#fff;}.layerpic{max-width:640px;min-width:320px;width:100%;}.layervideo{max-width:640px;min-width:320px;width:100%;height:100%;background-color:transparent !important;box-shadow: 0 0 0 rgba(0,0,0,0) !important;} #layui-video{overflow:hidden !important;}.layui-layer-content p{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.wrapper {margin:10px;display: none;}.wrapper .search{display: flex;align-items: center;justify-content:center;width:315px;height:50px;margin:15px auto;box-sizing: border-box;}.wrapper .search-input{flex: 1;box-sizing:border-box;padding:10px;height:100%;background-color:#f7f7f7;border-radius: 9px 0 0 9px;border: 1px solid #ff5983;display:block;overflow: hidden;}.input, .input-wrapper {outline:none;border:none;text-decoration:inherit;}.input-wrapper{display:flex;position:relative;width:100%;height:100%;-webkit-box-orient: vertical;-webkit-box-direction: normal;flex-direction: column;-webkit-box-pack: center;justify-content:center;}.input{background:none;font-size:16px;height:28px;line-height:28px;}.wrapper #search-btn{display:flex;align-items:center;justify-content:center;height:100%;width:75px;background-color:#ff5983;color:#fff;font-size:16px;font-weight: 700;border-radius: 0 9px 9px 0;cursor: pointer;}.wrapper .result-list{margin-top:10px;border-radius:10px;background-color:#eeeeee;color:#1e80ff;border: 1px dashed #ccc;}.wrapper .result-list-item{padding:10px;position:relative;}.wrapper .result-content {display:flex;}.wrapper .result-content-left {width: calc(70% - 5px);margin-right: 10px;}.wrapper .result-value{width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:flex;align-items:center;}.wrapper .result-value a{color: #1e80ff;}.wrapper .result-logo{width:15px;height:15px;border-radius:100%;margin-right: 5px;display:block;background-position: 0% 0%;background-size:100% 100%;background-repeat:no-repeat;}.wrapper .result-list-value{width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right;}.wrapper .result-list-right{width:calc(30% - 5px);}.Pic-label{text-align:center;line-height:30px;}#PicUpload {border: 2px dashed #ccc;text-align:center;padding:20px;margin: 0 auto;height:100px;cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center;}#PicUpload.highlight {border-color: #4CAF50;background-color: #f8f8f8;}fieldset{padding:0 10px 10px;border:2px solid #ccc;}legend{text-align:center;padding:0 10px;}label{position:relative;cursor:pointer;}label::after{content:attr(data-hover);display:none;position:absolute;left:50%;top:100%;transform:translateX(-50%);background-color:#ff5983;padding:0 6px;color:#FFF;font-size:12px;border-radius:4px;white-space:nowrap;} label:hover::after {display:block;}.loadMore{cursor:pointer;display:block;position:relative;line-height:57px;text-align:center;width:100%;color:#10aae4}
</style>
<script language="javascript">if (/\/\/www\./i.test(location.href)) location.href = location.href.replace(/\/\/www\./i,"//");</script>
</head>
<body>
<div class="contant">
    <div class="header">
        <div class="top">
            <div class="logo" id="logo"></div>
        </div>
    </div>
    <div class="navbar">
        <ul>
            <li><a id="Pic" href="javascript:void(0);" onclick="Pic()">图床</a></li>
            <li><a id="Mid" href="javascript:void(0);" onclick="Mid()">音乐</a></li>
            <li><a id="Flv" href="javascript:void(0);" onclick="Flv()">短剧</a></li>
            <li><a id="LOL" href="javascript:void(0);" onclick="LOL()">沙雕</a></li>
        </ul>
    </div>

    <div id="Mid-assort" class="wrapper">
        <div class="search"><div class="search-input"><div class="input-wrapper"><input maxlength="140" enterkeyhint="search" autocomplete="off" type="search" class="input" id="Mid-input" placeholder="请输入歌名"></div></div><div id="search-btn" href="javascript:void(0);" onclick="search_click('#Mid-input')">搜 歌</div></div>
        <div id="Mid-key"></div>
        <div id="Mid-data"></div>
    </div>

    <div id="Flv-assort" class="wrapper">
        <div class="search"><div class="search-input"><div class="input-wrapper"><input maxlength="140" enterkeyhint="search" autocomplete="off" type="search" class="input" id="Flv-input" placeholder="请输入短剧名"></div></div><div id="search-btn" href="javascript:void(0);" onclick="search_click('#Flv-input')">搜 剧</div></div>
        <div id="Flv-key"></div>
        <div id="Flv-data"></div>
    </div>

    <div id="LOL-assort" class="wrapper">
        <div id="LOL-data"></div>
        <div id="LOL-loadMore" class="loadMore"></div>
    </div>

    <div id="Pic-assort" class="wrapper">
        <fieldset><legend>图床使用说明</legend><p>1、图片托管于各大官网，最大支持10MB；</p><p>2、禁止上传违规图片，造成后果自负；</p><p>3、<a href="https://s.qiniu.com/eEFNBz" target="_blank" style="color:red;">七牛云存储</a> <a href="https://mp34.lanzout.com/iP8pR230laif" target="_blank" style="color:#0c6ad4;">七牛图床源码下载</a><a href="javascript:void(0);" onclick="picdata()">；</a></p></fieldset>
        <div class="Pic-label">
            <label data-hover="推荐使用"><input checked type="radio" name="type" value="wy">网易</label>
            <label data-hover="推荐使用"><input type="radio" name="type" value="mt">美图</label>
            <label data-hover="有水印"><input type="radio" name="type" value="bd">百度</label>
            <label data-hover="腾讯云对象存储"><input type="radio" name="type" value="bk">备用</label>
        </div>
        <div id="PicUpload">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" style="color:#ff5983;"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
            <p>选择或拖拽图片到此处，支持多图上传</p>
            <input type="file" id="fileInput" multiple accept="image/*" style="display:none;">
        </div>
        <div id="Pic-data"></div>
        <div id="Pic-loadMore" class="loadMore"></div>
    </div>

    <div class="bottom">
        <div class="childdiv"><a href="./">主页</a></div>
        <div class="childdiv"><a href="javascript:scroll(0,0)"><b>圈子</b></a></div>
    </div>
</div>
<script type="text/javascript" src="https://s4.zstatic.net/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script type="text/javascript" src="https://s4.zstatic.net/ajax/libs/layer/3.5.1/layer.min.js"></script>
<script type="text/javascript">
$(function(){
    const handler = {"#v":Flv,"#s":LOL,"#m":Mid};
    window.onload = (handler[window.location.hash] || Pic)();
});
function search_click(key){
    const txt = $(key).val();
    if(txt.trim().length==0){
        layer.tips(PopUpMsg(9),key,{tips:[3,'#ff5983']});
        return false;
    }
    if(key=='#Mid-input'){
        Mid_data(txt);
    } else if (key=='#Flv-input'){
        Flv_search(txt);
    }
}
function Mid(){
    $('#LOL-assort').hide();
    $('#LOL').removeClass('xhx');
    $('#Flv').removeClass('xhx');
    $('#Flv-assort').hide();
    $('#Pic-assort').hide();
    $('#Pic').removeClass('xhx');
    $('#Mid-assort').show();
    $('#Mid-key').show();
    $('#Mid-data').hide();
    $('#Mid').addClass('xhx');
    $('#Mid-input').val('');
    window.location.hash = "m";
    document.title = "搜音库-你想要的的歌曲库";
    $("#logo").css("background-image", "url('https://img0.baidu.com/it/u=3244688120,588283986&fm=253')");
    const Midkey = $('#Mid-key').html();
    if(Midkey.trim().length==0){
		CATCH("Mid_hot","music&ac=hot");
    }
}
function Mid_hot(list) {
    if (list.msg){
        const data  = list.data;
        const Total = data.length;
		const number = Math.floor(Total / 4) * 4;
        for (var i = 0; i < number; i++) {
            const img = data[i].img;
            const author = data[i].author;
            const s_name = data[i].name;
            const s_id = data[i].id;
            const s_Key = data[i].Key;
            if (s_name != null || s_name.trim().length !== 0){
                $("#Mid-key").append('<li style="display:inline-block;width:23%;margin:10px 1%;height:0;padding-bottom:30%;position:relative;border-radius:8px;"><a href="javascript:void(0);" onclick="Mid_url(\''+s_id+'\',\''+s_Key+'\')" style="width:100%;padding-bottom:100%;border-radius:8px;overflow:hidden;background-repeat:no-repeat;background-position:center;background-size:cover;position:relative;display:block;background-image:url('+img+');"></a><span style="overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;line-height:15px;padding-top: 5px;font-size:.875rem;">'+s_name+'</span><span style="overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;line-height:15px;padding-top: 5px;font-size:.875rem;">'+author+'</span></li>');
            }
        }
    } else {
        layer.msg(list.data, {icon: 2});
    }
}
function Mid_data(txt) {
    GP_data("music&wd="+txt,{method:'GET'},function(list){
        if (list.msg){
            const json = list.data; var number = json.length;
            $("#Mid-data").text('');
            for (var i = 0; i < number; i++) {
                const d = json[i].id;
                if (d != null || d.trim().length !== 0){
                    const n = json[i].name;
                    const a = json[i].artists;
                    const k = json[i].Key;
					const s = json[i].duration;
                    $("#Mid-data").append('<div class="result-list"><div class="result-list-item"><div class="result-content"><div class="result-content-left"><div class="result-value"><div class="result-logo" style="background-image: url(https://t14.baidu.com/it/u=729523279,2791742236&fm=179);"></div><a href="javascript:void(0);" onclick="Mid_url(\''+d+'\',\''+k+'\')">'+a+' - '+n+'</a></div></div><div class="result-list-right"><div class="result-list-value">'+s+'</div></div></div></div></div></div>');
                }
            }
            $('#Mid-data').show();
            $('#Mid-key').hide();
            $('#Mid-input').val(txt);
        } else {
            layer.msg(list.data, {icon: 2});
        }
    });
}
let canExecute = true;
function Mid_url(id,tk) {
	if (!canExecute) { PopUpMsg(7,2);  return; }
	canExecute = false;
    GP_data("music&id="+id+"&key="+tk,{method:'GET'},function(list){
        if (list.msg){
			const audio = new Audio();
			audio.src = list.data.url;
            layer.open({type:1,title:false,scrollbar:false,skin:'layerpic',content:'<div style="padding:20px;"><p>歌名：'+list.data.artist+' - '+list.data.name+'</p><p>封面：<a href="javascript:void(0);" onclick="copytxt(\''+list.data.img+'\')">'+list.data.img+'</a></p><p>地址：<a href="javascript:void(0);" onclick="copytxt(\''+list.data.url+'\')">'+list.data.url+'</a></p><p>本站只提供调试服务,不承担任何直接或间接的责任！</p></div>',btn:0,end:function() { audio.pause(); audio.currentTime = 0; audio.removeAttribute('src'); audio.load(); }});
			audio.play().catch(e => PopUpMsg(1,1) );
        } else {
            layer.msg(list.data, {icon: 2});
        }
    });
	setTimeout(() => {
        canExecute = true;
    },3000);
}
function Mid_play(url) {
	const audio = new Audio();
	audio.src = url;
	audio.play().catch(e => PopUpMsg(1,1) );
}
function Flv(){
    $('#Mid').removeClass('xhx');
    $('#Mid-assort').hide();
    $('#LOL-assort').hide();
    $('#LOL').removeClass('xhx');
    $('#Pic').removeClass('xhx');
    $('#Pic-assort').hide();
    $('#Flv').addClass('xhx');
    $('#Flv-assort').show();
    $('#Flv-key').show();
    $('#Flv-data').hide();
    $('#Flv-input').val('');
    window.location.hash = "v";
    document.title = "短剧池-全网短剧集聚地";
    $("#logo").css("background-image", "url('https://img0.baidu.com/it/u=3599983424,3153659671&fm=253')");
    const playkey = $('#Flv-key').html();
    if(playkey.trim().length==0){
		CATCH("Flv_hot","vod&ac=hot");
    }
}
function Flv_hot(list) {
	$("#Flv-key").text('');
	$('#Flv-key').show();
	$('#Flv-data').hide();
    if (list.msg){
        const data  = list.data;
        const Total = data.length;
		const number = Math.floor(Total / 4) * 4;
        for (var i = 0; i < number; i++) {
            const img = data[i].cover;
            const remarks = data[i].marks;
            const title = data[i].name;
            const episode = JSON.stringify(data[i]) .replace(/\\"/g, '"') .replace(/"/g, '&quot;');
            $("#Flv-key").append('<li style="display:inline-block;width:23%;margin:10px 1%;height:0;padding-bottom:39%;position:relative;border-radius:8px;"><a href="javascript:void(0);" onclick="Flv_data(\'['+episode+']\')" style="width:100%;padding-bottom:139%;border-radius:8px;overflow:hidden;background-repeat:no-repeat;background-position:center;background-size:cover;position:relative;display:block;background-image:url('+img+');"><svg viewBox="0 0 36 36" class="play-btn" width="36" height="36"><circle cx="18" cy="18" fill="#FFF" fill-opacity=".80" r="18"></circle>  <path d="M25.417 18.53L14.738 24.985a0.6 0.6 0 0 1-.832-.215 0.625 0.625 0 0 1-.085-.315V11.545c0-.341.271-.617.606-.617.11 0 .216.03.31.086l10.68 6.455a0.622 0.622 0 0 1 0 1.06z" fill="#444" fill-rule="nonzero"></path></svg></a><span style="overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;line-height:15px;padding-top: 5px;font-size:.875rem;">'+title+'</span><span style="overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;line-height:15px;padding-top: 5px;font-size:.875rem;">'+remarks+'</span></li>');
        }
    } else {
        layer.msg(list.data, {icon: 2});
    }
}
function Flv_search(txt) {
    GP_data("vod&wd="+txt,{method:'GET'},function(list){
        if (list.msg){
			Flv_hot(list);
        } else {
            layer.msg(list.data, {icon: 2});
        }
    });
}
function Flv_data(js) {
    $("#Flv-data").text('');
    const Flv = JSON.parse(decodeURIComponent(js));
    for (var i = 0; i < Flv.length; i++) {
        const vod = Flv[i].episode;
        const txt = Flv[i].name.replace(/\d+[-,、.]/g, '');
        if (vod != null){
            let html = '';
            for (var k = 0; k < vod.length; k++) {
                html  += '<a href="'+vod[k].url+'" target="_blank" style="background-color:#ff5983;color:white;text-align:center;display:inline-block;padding:2px 5px;margin:3px;border-radius:5px;">'+vod[k].name+'</a>';
            }
            $("#Flv-data").append('<div class="result-list"><div class="result-list-item"><p style="color:#0c6ad4;font-weight:700;font-size:16px;">'+txt+'-'+Flv[i].type+'</p><p>视频来自网络,别信视频广告,谨防上当受骗!</p>'+html+'</div></div></div>');
        }
    }
    $('#Flv-data').show();
    $('#Flv-key').hide();
    $('#Flv-input').val();
}
function LOL(){
    $('#Mid-assort').hide();
    $('#Mid').removeClass('xhx');
    $('#Pic-assort').hide();
    $('#Pic').removeClass('xhx');
    $('#Flv-assort').hide();
    $('#Flv').removeClass('xhx');
    $('#LOL-assort').show();
    $('#LOL').addClass('xhx');
    window.location.hash = "s";
    document.title = "搞笑圈子-我的快乐源泉";
    $("#logo").css("background-image", "url('https://img0.baidu.com/it/u=2203015616,2177196308&fm=253')");
    const data = $('#LOL-data').html();
    if(data.trim().length==0){
        LOL_data();
    }
}
function LOL_data(num){
    var page = isNaN(num) ? 0 : Number(num);
    GP_data("other&pg="+page,{method:'GET'},function(list){
        if (list.msg == false){
            layer.msg(list.data, {icon: 2});
            $("#LOL-loadMore").html(list.data);
        } else {
            var LOLdata = list.data;
            for (var i = 0; i < LOLdata.length; i++) {
                var user   = LOLdata[i].user; var cards  = LOLdata[i].cards; var title  = LOLdata[i].title;
                var avatar = LOLdata[i].avatar; var outimg = "";var css = "";
                if (cards.length === 1){ var css = "width:65%;padding-bottom:35%;";}
                for (var ii = 0; ii < cards.length; ii++) {
                    var imgurl = cards[ii].img_url;
                    var origin = cards[ii].img_url_big;
                    var video  = cards[ii].mp4_url;
                    if (video === '' || video.trim().length === 0){
                        var outimg = outimg+'<li style="background-image:url('+imgurl+');background-position:center;background-size:cover;'+css+'" onclick="eject(\''+origin+'\',\'pic\')"></li>';
                    }else{
                        var outimg = outimg+'<li style="background-image:url('+imgurl+');background-position:center;background-size:cover;'+css+'" onclick="eject(\''+video+'\',\'video\',\''+imgurl+'\')"><svg viewBox="0 0 72 72" class="play-btn"><circle cx="36" cy="36" fill="#FFF" fill-opacity=".80" r="36"></circle><path d="M50.835 37.06L29.477 49.97a1.203 1.203 0 0 1-1.664-.43 1.25 1.25 0 0 1-.17-.631V23.091c0-.682.543-1.234 1.213-1.234.219 0 .433.06.62.173l21.359 12.91a1.245 1.245 0 0 1 0 2.12z" fill="#444" fill-rule="nonzero"></path></svg></li>';
                    }
                }
                $("#LOL-data").append('<div class="itemg"><div class="itemg_lf"><img src="'+avatar+'"></div><div class="itemg_rg"><div class="itemg_rg_tp"><span>'+user+'</span></div><div class="itemg_rg_sm">'+title+'</div><div class="itemg_rg_main"><ul>'+outimg+'</ul></div></div></div>');
            }
            var next = page+1;
            $("#LOL-loadMore").html('<div onclick="LOL_data('+next+')">加载更多...</div>');
        }
    });
}
function Pic(){
    $('#Mid-assort').hide();
    $('#Mid').removeClass('xhx');
    $('#Flv-assort').hide();
    $('#Flv').removeClass('xhx');
    $('#LOL-assort').hide();
    $('#LOL').removeClass('xhx');
    $('#Pic').addClass('xhx');
    $('#Pic-assort').show();
    window.location.hash = "t";
    document.title = "图床-免费图片托管链接";
    $("#logo").css("background-image", "url('https://img0.baidu.com/it/u=1895635493,1543052772&fm=253')");
    if (localStorage.getItem("img")!=null){
        var arrr = new String(localStorage.getItem("img")).split(","); var data = '';
        for (i=0;i<arrr.length;i++ ){
            data += '<li style="background-image:url('+arrr[i]+');background-position:center;background-size:cover;display:inline-block;width:23%;margin:10px 1%;height:0;padding-bottom:30%;position:relative;cursor:pointer;" onclick="copytxt(\''+arrr[i]+'\')" title="点击复制图链"></li>';
        }
        $("#Pic-data").html(data);
        $("#Pic-data").show();
    }
    const PicUpload = document.getElementById('PicUpload');
    const fileInput = document.getElementById('fileInput');
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => { PicUpload.addEventListener(eventName, preventDefaults, false); });
    ['dragenter', 'dragover'].forEach(eventName => { PicUpload.addEventListener(eventName, highlight, false); });
    ['dragleave', 'drop'].forEach(eventName => { PicUpload.addEventListener(eventName, unhighlight, false); });
    PicUpload.addEventListener('drop', handleDrop, false);
    PicUpload.addEventListener('click', function(e) { e.stopPropagation();fileInput.click(); });
    fileInput.addEventListener('change', function(e) { handleFiles(e); this.value = ""; });
}
function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }
function highlight() { PicUpload.classList.add('highlight'); }
function unhighlight() { PicUpload.classList.remove('highlight'); }
function handleDrop(e) { const files = e.dataTransfer.files; handleFiles({ target: { files } }); }
function handleFiles(e) {
    const files = e.target.files;
    Array.from(files).forEach(file => {
        const S = file.size; const M = 10;
        const t= $('input:radio[name="type"]:checked').val();
        if(!file){
            PopUpMsg(4,2);
        }else if(parseInt(S) >= parseInt(M*1024*1024)){  
            PopUpMsg(1,2);
        }else if(!t){  
            PopUpMsg(3,2);
        }else{
            var formData = new FormData();
            formData.append("file", file);
            formData.append("type", t);
            GP_data("upimg",{upfile:'upfile',data:formData,timeout:0},function(list){
                if (list.msg){
                    PopUpMsg(6,1);
                    $("#Pic-data").prepend('<li style="background-image:url('+list.data.img+');background-position:center;background-size:cover;display:inline-block;width:23%;margin:10px 1%;height:0;padding-bottom:30%;position:relative;cursor:pointer;" onclick="copytxt(\''+list.data.img+'\')" title="点击复制图链"></li>');
                    addlocal('img',list.data.img);
                } else {
                    layer.msg(list.data, {icon: 2});
                }
            });
        }
    });
}
function picdata(){
    layer.prompt({title:false,closeBtn:0,formType:1},function (value,index) {
        $("#Pic-data").html('');
        pic_data(value);
		layer.close(index);
    });
}
function pic_data(n,p){
    var page = isNaN(p) ? 1 : Number(p);
    $("#Pic-loadMore").html('');
    GP_data("upimg",{data:{land:n,p:page}},function(list){
        if (list.msg == false){
            layer.msg(list.data, {icon: 2});
        } else {
            var data = list.data; var num = data.length; var total= list.total; var img = '';
            for (var i = 0; i < num; i++) {
                var img = data[i].img;
                if (img != null || img.trim().length !== 0){
                    var id = data[i].id; var at = data[i].at; var ip = data[i].ip;
                    $("#Pic-data").append('<li id="'+id+'" style="display:inline-block;width:23%;margin:10px 1%;height:0;padding-bottom:30%;position:relative;"><span style="position:absolute;width:20px;height:20px;background-color:red;color:white;text-align:center;line-height:20px;cursor:pointer;z-index:99;" onclick="pic_del(\'#'+id+'\',\''+n+'\',\''+id+'\')">X</span><span style="background-image:url(\''+img+'\');background-position:center;background-size:cover;position:absolute;width:100%;height:100%;cursor:pointer;" onclick="eject(\''+img+'\',\'pic\',\''+ip+'\',\''+at+'\')"></span></li>');
                }
            }
            if (list.total > "20"){var next = page+1; $("#Pic-loadMore").html('<div onclick="pic_data(\''+n+'\',\''+next+'\')">加载更多...</div>');}
        }
    });
}
function pic_del(i,n,id){
    GP_data("upimg",{data:{land:n,del:id}},function(list){ if (list.msg) { $(i).remove(); layer.msg(list.data, {icon: 1}); } else { layer.msg(list.data, {icon: 2});} });
}
function check_ip(ip){
    GP_data(ip,{method:'GET',tp:"getip"},function(list){
        if (isEmpty(list.data.address)){
            $("#ipres").html(PopUpMsg(8));
        } else {
            $("#ipres").html(list.data.address+list.data.isp);
        }
    });
}
function addlocal(type,value){
    if (localStorage.getItem(type)==null) {
        var data = value;
    } else {
        var data = value + ',' + localStorage.getItem(type);
    }
    localStorage.setItem(type,data);
}
function eject(u,t,i,a) { 
    var loadeject = layer.load(0, {shade:false});
    if (t == "pic"){
        if (i||a) { var x='<p>图片链接：<a href="javascript:void(0);" onclick="copytxt(\''+u+'\')">'+u+'</a></p><p>上传时间：'+a+'</p><p>上传地址：<span id="ipres"><a href="javascript:void(0);" onclick="check_ip(\''+i+'\')">'+i+'</a></span></p>'; } else { var x=''; }
        getImageWidth(u,function(w,h){
            layer.open({type:1,title:false,scrollbar:false,shade:0.8,closeBtn:0,skin:'layerpic',shadeClose:true,content:x+'<img width="100%" src="'+u+'" onclick="layer.closeAll()" href="javascript:;">'});
            layer.close(loadeject);
        });
    }else if(t == "video"){
        layer.open({type:1,title:false,scrollbar:false,shade:0.8,closeBtn:0,id:'layui-video',skin:'layervideo',shadeClose:true,content:'<video id="myVideo" controls width="100%" height="100%" oncontextmenu="return false;" controlslist="nodownload" poster="'+i+'" x5-playsinline="true" playsinline="true" webkit-playsinline="true" x-webkit-airplay="true" x5-video-orientation="portraint"><source src="'+u+'" type="video/mp4"></video><script type="text/javascript">var video = document.getElementById("myVideo"); video.play(); video.addEventListener("ended", function() { video.play(); }, false); video.muted = false; <'+'/script>'});  $("#layui-video").css("overflow","hidden !important"); layer.close(loadeject);
    }
}
function getImageWidth(url,callback) {
    var img = new Image();
    img.src = url;
    if (img.complete) {
        callback(img.width, img.height);
    } else {
        img.onload = function () {
            callback(img.width, img.height);
        };
        img.onerror = function() {
            PopUpMsg(2,2);
        };
    }
}
function copytxt(d) {
    var input = document.createElement('input');
    input.setAttribute('readonly', 'readonly');
    input.setAttribute('value', d);
    document.body.appendChild(input);
    input.select();
    input.setSelectionRange(0, 9999);
    document.execCommand('Copy');
    input.remove();
    PopUpMsg(5,1);
}
function isEmpty(value) {
    return value === null || value === undefined || value === "" || (typeof value === "string" && value.trim() === "");
}
function PopUpMsg(i,n) {
    const Arr = ["请求超时！","图片超过限制大小！","图片加载失败！","请选择上传接口！","未选择任何文件！","复制成功！","上传成功，点击图片复制！","请勿频繁点击！","未查到地址信息！","关键词不能为空！"];
    if (isEmpty(n)) { return Arr[i]; }
    layer.msg(Arr[i], {icon:n});
}
function GP_data(txt,options,callback) {
    const method = options.method || 'POST';
    const data = options.data || {};
    const headers = options.headers || {};
    const upfile = options.upfile || '';
    const timeout = options.timeout || 5000;
    const tp = options.tp || '';
    const dataType = options.dataType || 'json';
    const ubank = {weibo:"https://widget.weibo.com/public/aj_relationship.php?fuid=",getip:"https://v2.xxapi.cn/api/ip?ip=",i6xcn:"//i6x.18z.fun/i6x.php?type="};
    const url = ubank[tp] || ubank.i6xcn;
	const loadGP = layer.load(0, {shade: false});
    $.ajax({
        url: url+txt,
        type: method,
        data: method === 'GET' ? null : data,
        dataType: dataType,
        timeout: timeout,
        contentType: upfile === 'upfile' ? false : undefined,
        processData: upfile === 'upfile' ? false : undefined,
        headers: headers,
        success: function(list) {
            callback(list);
			layer.close(loadGP);
        },
        error: function() {
            callback({msg:false,data:PopUpMsg(0)});
			layer.close(loadGP);
        }
    });
}
function getToday() {
    let date = new Date();
    let Y = date.getFullYear();
    let M = date.getMonth()+1;
    let D = date.getDate();
    return `${Y}-${M}-${D}`;
}
function CATCH(KEY,	URL) {
    let CATCH_DATA = window.localStorage.getItem(KEY);
    let data = JSON.parse(CATCH_DATA);
    if (data !== null && data !== undefined && data.validDate === getToday()) {
        if(typeof window[KEY] === 'function') { return window[KEY](data.list);  }
    } else {
        GP_data(URL,{method:'GET'},function(list){
            if (list.msg){
                window.localStorage.setItem(KEY, JSON.stringify({ list, validDate: getToday(), }) );
                if(typeof window[KEY] === 'function') { return window[KEY](list);  }
            } else {
                layer.msg(list.data, {icon: 2});
            }
        });
    }
}
</script>
<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js?id=Kka10BqOTeAASZd4&ck=Kka10BqOTeAASZd4&autoTrack=true&screenRecord=true"></script>
</body>
</html>
